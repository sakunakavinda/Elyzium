<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Event Homepage</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
body {
    font-family: 'Poppins', sans-serif;
    background: #000;
    color: #fff;
    margin: 0;
}
.wrapper { max-width: 1200px; margin: 0 auto; padding: 0 20px; }

header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 20px 0;
}
.logo-container img { height: 60px; }
.event-title { font-size: 1.8rem; font-weight: 700; color: #00ffcc; letter-spacing: 2px; }

.cover-image img { width: 100%; border-radius: 12px; margin-bottom: 20px; }

.event-details {
    display: flex;
    gap: 40px;
    margin-bottom: 60px;
}
.details, .ticket-categories { flex: 1; }
.details .info p { margin: 8px 0; }
.ticket-categories h2 { margin-bottom: 10px; }
.ticket { display: flex; justify-content: space-between; margin-bottom: 10px; }
.ticket-divider { border: 0; border-top: 1px solid rgba(255,255,255,0.2); margin: 10px 0; }

button {
    padding: 12px 24px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-weight: 600;
    margin-top: 10px;
}
#contactDetailsBtn { background: #1d8240; color: #fff; }
#contactDetailsBtn:hover { background: #14612d; }
#buyTicketsBtn { background: #00ffcc; color: #000; }
#buyTicketsBtn:hover { background: #00cc99; }

footer {
    background: #000;
    color: #00ffcc;
    text-align: center;
    padding: 2rem 1rem;
    font-size: 0.9rem;
}
footer .social-icons a { color: #00ffcc; margin: 0 8px; text-decoration: none; }
footer .social-icons a:hover { color: #fff; }

@media (max-width: 992px) {
    .event-details { flex-direction: column; gap: 20px; }
    .cover-image img { margin-bottom: 20px; }
}
</style>
</head>
<body>
<div class="wrapper">
    <!-- Header -->
    <header>
        <div class="logo-container">
            <img src="images/logo.png" alt="Elyzium Events Logo" class="logo">
        </div>
        <div class="event-title">ELYZIUM EVENTS</div>
    </header>

    <!-- Cover Image -->
    <div class="cover-image">
        <img id="eventCover" src="images/default-event.png" alt="Event Cover">
    </div>

    <!-- Event Details -->
    <main>
        <section class="event-details">
            <div class="details">
                <p id="eventDescription" class="description">
                    Join us for an unforgettable evening under the stars!
                </p>
                <div class="info">
                    <p><strong>Date:</strong> <span id="eventDate">Not scheduled</span></p>
                    <p><strong>Time:</strong> <span id="eventTime">Not scheduled</span></p>
                    <p><strong>Venue:</strong> <span id="eventVenue">Not scheduled</span></p>
                    <p><strong>Event By:</strong> <span id="eventOrganizer">Elyzium Events</span></p>
                </div>
                <button id="contactDetailsBtn">Contact for more details</button>
            </div>

            <!-- Ticket Categories -->
            <div class="ticket-categories">
                <h2>Ticket Prices</h2>
                <div id="ticketsList"></div>
                <button id="buyTicketsBtn">Buy Tickets</button>
            </div>
        </section>
    </main>
</div>

<!-- Footer -->
<footer>
    <div class="contact-details">
        <p><strong>Contact Us:</strong></p>
        <p>Email: elyziumevent@gmail.com</p>
        <p>Phone: +94 71 653 1817</p>
        <div class="social-icons">
            <a href="https://www.instagram.com/sakunakavindaa/?next=%2F" target="_blank"><i class="fab fa-instagram"></i></a>
            <a href="https://www.facebook.com/tadashi.hamada.16940" target="_blank"><i class="fab fa-facebook"></i></a>
            <a href="https://wa.me/94716531817" target="_blank"><i class="fab fa-whatsapp"></i></a>
            <a href="mailto:elyziumevent@gmail.com"><i class="fas fa-envelope"></i></a>
        </div>
    </div>
</footer>

<script type="module">
import { doc, getDoc } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";
import { db } from "./auth.js"; // your Firebase init file

function getEventId() {
    const params = new URLSearchParams(window.location.search);
    return params.get('id');
}

async function loadEventDetails() {
    const eventId = getEventId();
    if (!eventId) return;

    const docRef = doc(db, "events", eventId);
    const docSnap = await getDoc(docRef);

    if (docSnap.exists()) {
        const event = docSnap.data();

        document.getElementById("eventCover").src = event.flyerUrl || "images/default-event.png";
        document.getElementById("eventDescription").textContent = event.description || "No description available.";
        document.getElementById("eventDate").textContent = event.date || "Not scheduled";
        document.getElementById("eventTime").textContent = event.time || "Not scheduled";
        document.getElementById("eventVenue").textContent = event.venue || "Not scheduled";
        document.getElementById("eventOrganizer").textContent = event.organizer || "Elyzium Events";

        // Dynamically render tickets
        const ticketsList = document.getElementById("ticketsList");
        ticketsList.innerHTML = "";

        if (event.ticketTypes && Array.isArray(event.ticketTypes)) {
            event.ticketTypes.forEach(ticket => {
                if (ticket.name && ticket.price) {
                    const div = document.createElement("div");
                    div.className = "ticket";
                    div.innerHTML = `
                        <p>${ticket.name}</p>
                        <p class="price">${ticket.price} LKR</p>
                    `;
                    ticketsList.appendChild(div);

                    const hr = document.createElement("hr");
                    hr.className = "ticket-divider";
                    ticketsList.appendChild(hr);
                }
            });
        } else {
            ticketsList.innerHTML = "<p>No tickets available</p>";
        }

        // Buttons
        document.getElementById("buyTicketsBtn").onclick = () => {
            window.location.href = `buy.html?id=${eventId}`;
        };
        document.getElementById("contactDetailsBtn").onclick = () => {
            window.open(event.contactUrl || "https://wa.me/94716531817");
        };

    } else {
        alert("Event not found!");
    }
}

loadEventDetails();
</script>
</body>
</html>