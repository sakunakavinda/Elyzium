<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Event Homepage</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="wrapper">
    <!-- Header -->
    <header>
        <div class="logo-container">
            <img src="images/logo.png" alt="Elyzium Events Logo" class="logo">
        </div>
        <div class="event-title">ELYZIUM EVENTS</div>
    </header>

    <!-- Cover Image -->
    <div class="cover-image">
        <img id="eventCover">
    </div>

    <!-- Event Details -->
    <main>
        <section class="event-details">
            <div class="details">
                <p id="eventDescription" class="description">
                    Join us for an unforgettable evening under the stars!
                </p>
                <div class="info">
                    <p><strong>Date:</strong> <span id="eventDate">Not scheduled</span></p>
                    <p><strong>Time:</strong> <span id="eventTime">Not scheduled</span></p>
                    <p><strong>Venue:</strong> <span id="eventVenue">Not scheduled</span></p>
                    <p><strong>Event By:</strong> <span id="eventOrganizer">Elyzium Events</span></p>
                </div>
                <button id="contactDetailsBtn">Contact for more details</button>
            </div>

            <!-- Ticket Categories -->
            <div class="ticket-categories">
                <h2>Ticket Prices</h2>
                <div class="ticket">
                    <p>Picnic Mat Seating</p>
                    <p class="price" id="priceMat">1000 LKR</p>
                </div>
                <hr class="ticket-divider">
                <div class="ticket">
                    <p>Camping Chair Seating</p>
                    <p class="price" id="priceChair">1500 LKR</p>
                </div>
                <hr class="ticket-divider">
                <button id="buyTicketsBtn">Buy Tickets</button>
            </div>
        </section>
    </main>
</div>

<!-- Footer -->
<footer>
    <div class="contact-details">
        <p><strong>Contact Us:</strong></p>
        <p>Email: elyziumevent@gmail.com</p>
        <p>Phone: +94 71 653 1817</p>
        <div class="social-icons">
            <a href="https://www.instagram.com/sakunakavindaa/?next=%2F" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
            <a href="https://www.facebook.com/tadashi.hamada.16940" target="_blank" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
            <a href="https://wa.me/94716531817" target="_blank" aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
            <a href="mailto:elyziumevent@gmail.com" aria-label="Email"><i class="fas fa-envelope"></i></a>
        </div>
    </div>
</footer>

<script type="module">
import { doc, getDoc } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";
import { db } from "./auth.js"; // your Firebase init file

// Helper to get event ID from URL
function getEventId() {
    const params = new URLSearchParams(window.location.search);
    return params.get('id');
}

async function loadEventDetails() {
    const eventId = getEventId();
    if (!eventId) return;

    const docRef = doc(db, "events", eventId);
    const docSnap = await getDoc(docRef);
    if (docSnap.exists()) {
        const event = docSnap.data();
        document.getElementById("eventCover").src = event.flyerUrl;
        document.getElementById("eventDescription").textContent = event.description || "No description available.";
        document.getElementById("eventDate").textContent = event.date || "Not scheduled";
        document.getElementById("eventTime").textContent = event.time || "Not scheduled";
        document.getElementById("eventVenue").textContent = event.venue || "Not scheduled";
        document.getElementById("eventOrganizer").textContent = event.organizer || "Elyzium Events";
        document.getElementById("priceMat").textContent = event.priceMat ? `${event.priceMat} LKR` : "1000 LKR";
        document.getElementById("priceChair").textContent = event.priceChair ? `${event.priceChair} LKR` : "1500 LKR";

        // Buy tickets button link
        document.getElementById("buyTicketsBtn").onclick = () => {
            window.location.href = `buy.html?id=${eventId}`;
        }

        // Contact button link
        document.getElementById("contactDetailsBtn").onclick = () => {
            window.open(event.contactUrl || "https://wa.me/94716531817");
        }
    } else {
        alert("Event not found!");
    }
}

// Load event details on page load
loadEventDetails();
</script>
</body>
</html>